<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Soccer Match Predictor</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="css/prediction.css">
    <style>
        /* Add CSS for notification animations */
        @keyframes slideIn {
            from { transform: translateX(100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }
        @keyframes slideOut {
            from { transform: translateX(0); opacity: 1; }
            to { transform: translateX(100%); opacity: 0; }
        }
    </style>
</head>
<body>
    <!-- Header Section -->
    <header>
        <div class="container">
            <div class="header-content">
                <div class="logo">
                    <i class="fas fa-futbol logo-icon"></i>
                    <div>
                        <h1>Soccer Match Predictor</h1>
                        <p class="tagline">Upload your CSV data for statistical match predictions</p>
                    </div>
                </div>
                <div>
                    <button class="btn btn-red" id="clearDataBtn">
                        <i class="fas fa-trash"></i> Clear Data
                    </button>
                </div>
            </div>
        </div>
    </header>
    
    <div class="container">
        <!-- Navigation Section -->
        <div class="navigation">
            <a href="odds-analyzer.html" class="nav-link">
                <i class="fas fa-calculator"></i> Odds Analyzer
            </a>
            <a href="prediction.html" class="nav-link active">
                <i class="fas fa-futbol"></i> Soccer Predictor
            </a>
        </div>
        
        <!-- League Selector Section -->
        <div class="card">
            <h2><i class="fas fa-database"></i> Select League Data Source</h2>
            
            <div class="form-group">
                <label>Choose Pre-loaded League <span class="stats-tag">Optional - Use instead of CSV upload</span></label>
                <div class="league-selector">
                    <div class="league-options">
                        <div class="league-option" data-league="laliga">
                            <div class="league-icon">
                                <img src="https://1000logos.net/wp-content/uploads/2019/01/Spanish-La-Liga-Logo.png" 
                                    alt="La Liga Logo" class="league-logo">
                            </div>
                            <div class="league-info">
                                <div class="league-name">La Liga</div>
                                <div class="league-teams">20 Teams</div>
                            </div>
                            <i class="fas fa-check league-check" style="display: none;"></i>
                        </div>

                        <div class="league-option" data-league="premierleague">
                            <div class="league-icon">
                                <img src="https://cdn.ssref.net/req/202512111/tlogo/fb/9.png" 
                                    alt="Premier League Logo" class="league-logo">
                            </div>
                            <div class="league-info">
                                <div class="league-name">Premier League</div>
                                <div class="league-teams">20 Teams</div>
                            </div>
                            <i class="fas fa-check league-check" style="display: none;"></i>
                        </div>

                        <div class="league-option" data-league="seriea">
                            <div class="league-icon">
                                <img src="https://assets.football-logos.cc/logos/italy/512x512/serie-a.1289b16a.png" 
                                    alt="Serie A Logo" class="league-logo">
                            </div>
                            <div class="league-info">
                                <div class="league-name">Serie A</div>
                                <div class="league-teams">20 Teams</div>
                            </div>
                            <i class="fas fa-check league-check" style="display: none;"></i>
                        </div>

                        <div class="league-option" data-league="bundesliga">
                            <div class="league-icon">
                                <img src="https://cdn.ssref.net/req/202512111/tlogo/fb/20.png" 
                                    alt="Bundesliga Logo" class="league-logo">
                            </div>
                            <div class="league-info">
                                <div class="league-name">Bundesliga</div>
                                <div class="league-teams">18 Teams</div>
                            </div>
                            <i class="fas fa-check league-check" style="display: none;"></i>
                        </div>

                        <div class="league-option" data-league="custom">
                            <div class="league-icon">
                                <i class="fas fa-file-upload league-custom-icon"></i>
                            </div>
                            <div class="league-info">
                                <div class="league-name">Custom CSV</div>
                                <div class="league-teams">Upload your own</div>
                            </div>
                            <i class="fas fa-check league-check" style="display: none;"></i>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="info-box" id="leagueInfo" style="display: none;">
                <i class="fas fa-info-circle"></i> 
                <div>
                    <strong id="selectedLeagueName">No league selected</strong>
                    <div id="selectedLeagueStats" style="font-size: 0.9rem;"></div>
                </div>
            </div>
            
            <button class="btn btn-blue" id="processDataBtn" disabled>
                <i class="fas fa-cogs"></i> Process League Data
            </button>
        </div>
        
        <!-- CSV Upload Section -->
        <div class="card" id="csvUploadCard">
            <h2><i class="fas fa-file-upload"></i> Upload CSV Data File</h2>
            
            <div class="info-box">
                <i class="fas fa-info-circle"></i> 
                <strong>Required CSV Format:</strong> Your CSV file should contain team statistics for all teams.
                <div style="margin-top: 10px;">
                    <strong>Required Columns:</strong> Squad, MP, W, D, L, GF, GA, xG, xGA 
                </div>
                <div style="margin-top: 10px; font-family: monospace; font-size: 0.9rem;">
                    Example row: "Barcelona,17,14,1,2,49,20,38.8,21.7"
                </div>
            </div>
            
            <div class="form-group">
                <label>Upload Teams CSV <span class="stats-tag">Required for custom data</span></label>
                <div class="file-upload-area" id="csvUpload">
                    <div class="file-upload-icon">
                        <i class="fas fa-file-csv"></i>
                    </div>
                    <p><strong>Click to upload</strong> or drag and drop</p>
                    <p style="color: #666; font-size: 0.9rem;">Teams statistics CSV file (used for both home and away)</p>
                    <input type="file" id="csvFile" accept=".csv" style="display: none;">
                    <div class="file-list" id="fileList"></div>
                </div>
            </div>
            
            <div class="data-status" id="dataStatus" style="display: none;">
                <i class="fas fa-check-circle" style="color: #4CAF50;"></i>
                <div>
                    <strong>Data Loaded Successfully</strong>
                    <div id="dataStats" style="font-size: 0.9rem;"></div>
                </div>
            </div>
        </div>
        
        <!-- Loading Indicator Section -->
        <div class="loading" id="loadingIndicator">
            <div class="loading-spinner"></div>
            <p>Processing CSV data...</p>
        </div>
        
        <!-- Matchup Display Section -->
        <div class="matchup-card" id="matchupDisplay">
            <div class="team-display">
                <div class="team" id="homeTeamDisplay">
                    <h3>Upload Data First</h3>
                    <div class="team-stats">
                        <div class="stat-item">
                            <div class="stat-value">-</div>
                            <div class="stat-label">xG</div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-value">-</div>
                            <div class="stat-label">xGA</div>
                        </div>
                    </div>
                </div>
                <div class="vs-text">VS</div>
                <div class="team" id="awayTeamDisplay">
                    <h3>Upload Data First</h3>
                    <div class="team-stats">
                        <div class="stat-item">
                            <div class="stat-value">-</div>
                            <div class="stat-label">xG</div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-value">-</div>
                            <div class="stat-label">xGA</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Prediction Settings Section -->
        <div class="card">
            <h2><i class="fas fa-sliders-h"></i> Prediction Settings</h2>
            <div class="form-group">
                <label for="homeTeam">Home Team</label>
                <select id="homeTeam" disabled>
                    <option value="">-- Upload CSV data first --</option>
                </select>
            </div>
            
            <div class="form-group">
                <label for="awayTeam">Away Team</label>
                <select id="awayTeam" disabled>
                    <option value="">-- Upload CSV data first --</option>
                </select>
            </div>
            
            <div id="teamStats" style="display: none;">
                <h3>Team Statistics</h3>
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="value" id="homeMP">-</div>
                        <div class="label">Matches</div>
                    </div>
                    <div class="stat-card">
                        <div class="value" id="homeW">-</div>
                        <div class="label">Wins</div>
                    </div>
                    <div class="stat-card">
                        <div class="value" id="homeGF">-</div>
                        <div class="label">Goals For</div>
                    </div>
                    <div class="stat-card">
                        <div class="value" id="homeGA">-</div>
                        <div class="label">Goals Against</div>
                    </div>
                    <div class="stat-card">
                        <div class="value" id="awayMP">-</div>
                        <div class="label">Matches</div>
                    </div>
                    <div class="stat-card">
                        <div class="value" id="awayW">-</div>
                        <div class="label">Wins</div>
                    </div>
                    <div class="stat-card">
                        <div class="value" id="awayGF">-</div>
                        <div class="label">Goals For</div>
                    </div>
                    <div class="stat-card">
                        <div class="value" id="awayGA">-</div>
                        <div class="label">Goals Against</div>
                    </div>
                </div>
            </div>
            
            <div class="form-group">
                <label>Betting Odds <span class="stats-tag">Optional - American Format</span></label>
                <div style="display: flex; gap: 15px;">
                    <div style="flex: 1;">
                        <label for="homeOdds" style="font-size: 0.9rem;">Home Win</label>
                        <input type="text" id="homeOdds" placeholder="+150" value="">
                    </div>
                    <div style="flex: 1;">
                        <label for="drawOdds" style="font-size: 0.9rem;">Draw</label>
                        <input type="text" id="drawOdds" placeholder="+220" value="">
                    </div>
                    <div style="flex: 1;">
                        <label for="awayOdds" style="font-size: 0.9rem;">Away Win</label>
                        <input type="text" id="awayOdds" placeholder="+140" value="">
                    </div>
                </div>
            </div>
            
            <div class="form-group">
                <label for="modelWeight">Model Weight <span class="stats-tag">0 = betting odds only, 1 = model only</span></label>
                <input type="range" id="modelWeight" min="0" max="1" step="0.1" value="0.6">
                <div style="display: flex; justify-content: space-between; margin-top: 5px;">
                    <span>Betting Odds</span>
                    <span id="weightValue">0.6</span>
                    <span>Model</span>
                </div>
            </div>
            
            <button class="btn btn-green" id="predictBtn" disabled>
                <i class="fas fa-magic"></i> Generate Prediction
            </button>
        </div>
        
        <!-- Prediction Results Section -->
        <div id="predictionResults" class="card" style="display: none;">
            <h2><i class="fas fa-trophy"></i> Prediction Results</h2>
            <div id="predictionContent"></div>
        </div>
        
        <!-- Model Explanation Section -->
        <div class="card">
            <h2><i class="fas fa-chart-line"></i> Statistical Model Explanation</h2>
            <div class="model-explanation">
                <div class="model-card">
                    <h4><i class="fas fa-calculator"></i> Poisson Distribution</h4>
                    <p>The model uses Poisson distribution to predict goal probabilities based on expected goals (xG) data.</p>
                    <div class="info-box" style="margin-top: 10px; padding: 0.8rem;">
                        <strong>Formula:</strong> P(k goals) = (λ^k * e^-λ) / k!
                    </div>
                </div>
                
                <div class="model-card">
                    <h4><i class="fas fa-balance-scale"></i> Hybrid Approach</h4>
                    <p>Combines statistical model predictions with betting market odds using adjustable weighting.</p>
                    <div class="info-box" style="margin-top: 10px; padding: 0.8rem;">
                        <strong>Formula:</strong> Final = (Model × Weight) + (Betting × (1-Weight))
                    </div>
                </div>
                
                <div class="model-card">
                    <h4><i class="fas fa-futbol"></i> xG Statistics</h4>
                    <p>Expected Goals (xG) measures the quality of chances. Higher xG = better scoring opportunities.</p>
                    <div class="info-box" style="margin-top: 10px; padding: 0.8rem;">
                        <strong>Calculation:</strong> Home Attack + Away Defense / 2
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <script src="js/prediction.js"></script>
</body>
</html>